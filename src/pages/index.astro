---
import PageLayout from "@layouts/PageLayout.astro";
import Container from "@components/Container/Container.astro";
import { MdOutlineMailOutline } from "react-icons/md";
import Footer from "@components/Footer/Footer.astro";
import Image from "astro/components/Image.astro";
import { FaExternalLinkAlt } from "react-icons/fa";
import { getPreferredLanguage } from "@i18n/utils";
import { HOME, SITE } from "@consts";
import { cn } from "@lib/utils";

type LinkType = {
	"title-es": string;
	"title-en": string;
	url: string;
	sections: {
		"title-es": string;
		"title-en": string;
		url: string;
	}[];
}

const userLang = getPreferredLanguage(Astro.request);

const links = (await (await fetch(import.meta.env.PORTFOLIO_SOURCE)).json()).links as Array<LinkType> ;

const classes = {
	link: cn("link-hover transition-all duration-200 ease-in-out hover:text-info"),
}
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <div class="py-16">
      <div class="text-center mb-16">
				<div class="flex justify-center my-4">
					<Image class="rounded-full shadow-lg" src={SITE.IMAGE} alt={SITE.NAME} width={100} height={100} />
				</div>
        <h1 class="text-3xl max-w-2xl mx-auto font- font-serif">
          {SITE.AUTHOR}
        </h1>
				<p>{SITE[`DESCRIPTION-${userLang}`]}</p>
      </div>

			<div>
				{links.map((link, index) => {
					const isContact = index === 2

					return (
					<article class="pb-2">
						<a href={link.url} target="_blank" class="btn btn-info btn-outline w-full rounded-full">
							{isContact ? <MdOutlineMailOutline /> : <FaExternalLinkAlt className="size-3" />}
							<span>{link[`title-${userLang}`]}</span>
						</a>
						<ul>
							{link?.sections?.map((section) => (
								<li class={cn(classes.link, "flex items-center gap-2 my-4 box-border")}>
									<FaExternalLinkAlt className="size-3 ml-4" />
									<a href={section.url} target="_blank">
										<span>{section[`title-${userLang}`]}</span>
									</a>
								</li>
							))}
						</ul>
					</article>
				)
				})}
			</div>

    </div>
  </Container>
  <Footer />
</PageLayout>